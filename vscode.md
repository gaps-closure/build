<h1> VS Code Notes</h1>

# Installation

Log on to jaga and create a project directory and cd to it
* mkdir helloworld
* cd helloworld

Copy VS Code project files
* cp -r ~tchen/test/helloworld/.vscode .

Copy source code
* cp -r ~tchen/test/helloworld/helloworld.cpp .

Start vs code
* code .

Do the following if the backspace key is not working in vnc.
* File>Preferences>Settings
* Type Keyboard into the search box.
* Select keyboard
* Change the value to keyCode

Install C/C++ extensions
* Select the bottom icon (four squares) and type c/c++ into the search box.
* Check 'C/C++ IntelliSense, debugging, and code browsing' is in the ENABLED box.
* If not, type C/C++ into the search box, find and install it.

Execute a build task defined in tasks.json
The following will compile helloworld.cpp and create the executable helloworld.out
* From the menu: "Terminal>Run Build Task"
* Keyboard shortcut: Ctrl-Shift-B

# Debugging
* only gdb is supported, not lldb
* if the code will spawn a subprocess and you want to debug the subprocess (e.g. clang)
* put the following in ~/.gdbinit
** set follow-fork-mode child
** set detach-on-fork off

Execute the debugging task in launch.json, do one of the following
* Debug>Start Debugging
* Keyboard Shortcut: F5

# Syntax Highlighting for CLE
At the moment, CLE syntax highlight consists of two extensions in cle-highlighter and cle-themes. These are derived from Reloaded-cpp and Reloaded-themese, repectively.

The relavant part regarding CLE pragma are cle-highlighter/syntaxes/c++.json.
    "preprocessor-pragma-cle": {
      "name": "meta.preprocessor.block",
      "match": "^\\s*((#)\\s*(pragma)\\s+(cle)\\s+(def))\\s+(.*)",
      "captures": {
        "1": { "name": "meta.preprocessor.command.cpp" },
        "2": { "name": "meta.preprocessor.hash.cpp" },
        "3": { "name": "operator.namespace-separator.cpp" },
        "4": { "name": "cle" },
        "5": { "name": "operator.namespace-separator.cpp" },
        "6": { "name": "meta.toc-list.pragma-mark.cpp" }
      }
    },

The "name"s in the captures field are the scopes defined in cle-themes/themes/reloaded-light-core.json. Currently only the cle scope is newly defined. The other are arbitrarily selected during experiments.
    { "scope": ["cle"]                     , "settings": { "foreground": "#67f0f5"  } },

To build cle-highlighter
   $ git clone tchen@mantessa2:/home/mantessa/src/cle-highlighter.git
   $ cd cle-highlighter
   $ vsce package
A .vsix file will be created in the current directory.
Repeat the above procedure for cle-themes. 

To sideload an extension (.vsix built locally)
  - Open Visual Studio Code
  - Select the Extensions pane.
  - Click the ... at the top-right corner of the Extensions pane and select "Install from VSIX..." on the menu that appears.
  - Locate the .vsix file and click "Install".
Watch vscode.mp4 if it is not clear.

Another extension is needed to view the .dot files generated by the partitioner.
  - Open Visual Studio Code
  - Select the Extensions pane.
  - Type dot in the search window
  - Select "Graphviz (dot) language support for Visual Studio Code".
    Note that there are two extensions with the same name. Choose the one by Joao Pinto.
Watch vscode.mp4 if it is not clear.

Partitioner tasks
The following tasks are defined in the partitioner project.
        Partitioner Compile,
        Partitioner Example Clang Build,
        Partitioner Preprocess,
        Partitioner LLVM IR and Bitcode Gen,
        Partitioner Create Dependency Graph,
        Partitioner Partition,
Each task depends on its immediate predecessor. All predecessors of a task will be run before the task itself is run.
To run all tasks, choose the Partiion task. The "Partitioner Clean" task cleans up all intermediate files.

To run a task,
  - Open Visual Studio Code
  - Select Terminal>Run Task
  - A list of Partitioner tasks will be displayed.
  - Select the task to run.
Watch vscode.mp4 if it is not clear.
